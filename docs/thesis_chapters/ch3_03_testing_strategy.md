# Глава 3. Разработка приложения (с фокусом на архитектуру)

## 3.3 Стратегия тестирования и оценки эффективности демонстрационного приложения

Поскольку основной целью разработки приложения в рамках данной ВКР являлась демонстрация возможностей ML-модели и ее интеграции в потенциальный рабочий процесс, стратегия тестирования фокусируется на проверке корректности работы ключевого функционала и обеспечении стабильной демонстрации. Полномасштабное тестирование, включающее нагрузочные тесты, тесты безопасности или длительное юзабилити-тестирование, выходит за рамки текущей работы.

### 3.3.1 План функционального тестирования

Функциональное тестирование направлено на проверку того, что каждый компонент и система в целом выполняют свои заявленные функции корректно. Тестирование будет проводиться вручную на основе следующих сценариев:

**1. Тестирование API-сервиса (FastAPI):**

*   **Загрузка ML-модели и трансформеров:**
    *   Проверка успешной загрузки основной модели (`best_model.pkl`) при старте приложения или первом обращении.
    *   Проверка успешной загрузки всех необходимых трансформеров из директории `output/models/transformers/` (скейлеры, энкодеры, PCA, KMeans, списки признаков).
    *   Проверка корректной обработки ситуации отсутствия файлов моделей или трансформеров (например, вывод информативного сообщения об ошибке, если это предусмотрено).
*   **Эндпоинт для классификации данных из CSV-файла (`/classify/csv` или аналогичный):**
    *   Тест с корректным CSV-файлом: проверка, что данные правильно считываются, обрабатываются и возвращаются предсказанные сегменты для всех клиентов.
    *   Тест с CSV-файлом, имеющим неверный формат или разделитель: проверка, что API возвращает ошибку.
    *   Тест с CSV-файлом, где отсутствуют некоторые обязательные колонки: проверка корректной обработки (например, возврат ошибки или использование значений по умолчанию, если это предусмотрено логикой).
    *   Тест с CSV-файлом, содержащим некорректные типы данных в колонках: проверка устойчивости API и корректности обработки ошибок.
    *   Тест с пустым CSV-файлом.
*   **Эндпоинт для классификации данных при ручном вводе (`/classify/manual` или аналогичный):**
    *   Тест с корректным набором входных данных: проверка, что данные принимаются, обрабатываются и возвращается предсказанный сегмент.
    *   Тест с отсутствующими обязательными полями: проверка, что FastAPI возвращает ошибку валидации Pydantic.
    *   Тест с некорректными типами данных (например, текст вместо числа): проверка ошибки валидации.
    *   Тест со значениями, выходящими за допустимые диапазоны (если такие проверки есть).
*   **Эндпоинт для получения информации о модели (`/model-info` или аналогичный):**
    *   Проверка, что эндпоинт возвращает корректную информацию (имя модели, метаданные).
*   **Эндпоинт для получения данных для диаграммы распределения (`/loyalty-distribution-data` или аналогичный):**
    *   Проверка, что эндпоинт возвращает данные в ожидаемом формате для построения диаграммы.

**2. Тестирование Пользовательского Интерфейса (UI):**

*   **Отображение главной страницы (`index.html`):**
    *   Проверка корректного отображения всех элементов: информация о модели, формы ввода/загрузки, блок для результатов, блок для диаграммы.
    *   Проверка загрузки и отображения информации об активной модели.
*   **Функционал ручного ввода данных:**
    *   Ввод корректных данных и отправка формы: проверка, что результат классификации отображается корректно.
    *   Ввод некорректных данных: проверка, что отображаются сообщения об ошибках валидации.
    *   Проверка реакции интерфейса на успешную/неуспешную классификацию.
*   **Функционал загрузки CSV-файла:**
    *   Загрузка корректного CSV: проверка, что результаты отображаются в таблице.
    *   Загрузка некорректного CSV (неверный формат, отсутствующие столбцы): проверка отображения сообщений об ошибках.
    *   Проверка отображения информации об ожидаемом формате CSV.
*   **Отображение результатов классификации:**
    *   Проверка четкости и понятности представления предсказанного сегмента.
    *   Для пакетной классификации – проверка корректности таблицы с результатами (наличие всех клиентов из файла, соответствие предсказаний).
*   **Отображение диаграммы распределения по сегментам:**
    *   Проверка, что диаграмма строится и отображает корректные данные.
    *   Проверка обновления диаграммы после новой операции классификации (если это предусмотрено).
*   **Общее удобство и понятность интерфейса:** Субъективная оценка того, насколько легко пользователю выполнить основные демонстрационные сценарии.

### 3.3.2 Критерии оценки работоспособности и эффективности для демонстрации

Поскольку приложение носит демонстрационный характер, основными критериями оценки будут:

1.  **Корректность выполнения основных сценариев:**
    *   Система должна правильно классифицировать клиентов как при ручном вводе, так и при загрузке CSV-файла, используя обученную модель LightGBM и соответствующие трансформеры.
    *   Результаты классификации, отображаемые в UI, должны соответствовать результатам, полученным напрямую от ML-модуля.
2.  **Стабильность работы:**
    *   Приложение не должно падать или выдавать необработанные ошибки при выполнении стандартных демонстрационных сценариев (корректный ввод, загрузка корректных файлов).
    *   Обработка некорректного ввода или файлов должна приводить к выводу понятных сообщений об ошибках, а не к отказу системы.
3.  **Наглядность демонстрации:**
    *   Пользовательский интерфейс должен четко отображать информацию о модели, позволять легко вводить/загружать данные и ясно представлять результаты классификации и распределение по сегментам.
4.  **Воспроизводимость процесса предобработки для новых данных:**
    *   Система должна корректно применять все необходимые шаги предобработки (загрузка и использование сохраненных трансформеров PCA, KMeans, скейлеров, энкодеров) к новым данным, чтобы обеспечить консистентность с процессом обучения модели.
    *   Стратегия обработки отсутствующих или невычисляемых из пользовательского ввода признаков (например, PCA-компонент) с помощью placeholder-значений должна быть реализована и не приводить к ошибкам во время демонстрации.
5.  **Соответствие документации:**
    *   Реализованный функционал должен соответствовать описанию, представленному в данной главе и в технической документации по архитектуре.

Успешное прохождение функциональных тестов по указанным сценариям и соответствие перечисленным критериям будет свидетельствовать о готовности демонстрационного приложения к представлению в рамках защиты ВКР. 