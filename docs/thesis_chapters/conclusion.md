# Заключение

В настоящей выпускной квалификационной работе было проведено исследование и разработка системы для классификации клиентов розничной сети детской одежды Acoola по уровню их лояльности. Основной целью работы являлось создание эффективной модели машинного обучения, способной идентифицировать различные сегменты клиентов, и проектирование архитектуры приложения для демонстрации ее работы.

В ходе выполнения работы были решены следующие ключевые задачи:

1.  **Проведен комплексный анализ и предобработка данных о клиентах и их транзакциях.** Исходный датасет `Concept202408.csv`, содержащий 418 888 записей, был тщательно очищен от пропущенных значений и выбросов. Были применены различные методы трансформации данных, включая Label Encoding, One-Hot Encoding, MinMaxScaler и StandardScaler, с сохранением соответствующих трансформеров для последующего использования.

2.  **Разработан и сконструирован расширенный набор признаков для оценки лояльности.** На основе агрегированных данных на уровне клиента был проведен RFM-анализ. Дополнительно были созданы 7 кастомных признаков, отражающих различные аспекты лояльности. Для обогащения признакового пространства применялись методы кластеризации K-Means (на 5 кластеров по 40 признакам) и снижения размерности PCA (3 компоненты). Итогом стал агрегированный признак `enhanced_loyalty_score`, на основе которого была сформирована бинарная целевая переменная для классификации: 'Высоколояльные' (87.37% выборки) и 'Отток' (12.63%). Для обучения моделей был отобран набор из 20 наиболее информативных признаков из 44 сгенерированных.

3.  **Разработаны, обучены и оценены различные модели машинного обучения.** Рассматривались такие алгоритмы, как Логистическая регрессия, Random Forest, Gradient Boosting (включая XGBoost и LightGBM) и SVM. Для оптимизации гиперпараметров ключевых моделей (Random Forest, XGBoost, LightGBM) использовалась библиотека Optuna с целевой метрикой F1-macro. В результате наилучшие показатели продемонстрировала модель LightGBM, достигнув F1-macro близкого к 1.0. Столь высокие метрики объясняются особенностями формирования целевой переменной `enhanced_loyalty_score` и результирующим дисбалансом классов, что сделало задачу классификации относительно простой для модели. Была проведена интерпретация лучшей модели с использованием SHAP values и встроенной важности признаков, выявившая ключевые драйверы лояльности, такие как `recency_ratio`, `monetary`, `pca_component_3`.

4.  **Спроектирована архитектура программного приложения для демонстрации работы ML-модели.** Был выбран API-first подход с использованием FastAPI для бэкенда и Jinja2-шаблонов для минимального пользовательского интерфейса. Архитектура предусматривает четкое разделение на компоненты: API-сервис, модуль машинного обучения, UI, а также опциональное использование базы данных и хранилища файлов. Подробное описание архитектуры представлено в технической документации проекта.

5.  **Детализировано проектирование основных функциональных блоков приложения.** Описаны процессы обработки входящих данных от пользователя (ручной ввод и загрузка CSV), взаимодействие с ML-моделью (загрузка модели LightGBM и всех необходимых трансформеров, применение пайплайна предобработки к новым данным), а также ключевые элементы пользовательского интерфейса для демонстрации классификации.

6.  **Разработана стратегия тестирования демонстрационного приложения.** Сформулированы план функционального тестирования и критерии оценки работоспособности, направленные на проверку корректности выполнения основных сценариев и стабильности приложения во время демонстрации.

Все поставленные цели выпускной квалификационной работы были достигнуты. Разработанная модель LightGBM показала высокую эффективность в задаче классификации клиентов на основе предложенного подхода к формированию признака лояльности. Спроектированная архитектура приложения и реализованные демонстрационные интерфейсы позволяют наглядно представить результаты работы модели и подтверждают возможность ее практического применения.

**Практическая значимость** работы заключается в создании инструмента, который может быть использован компанией Acoola для лучшего понимания своей клиентской базы, выявления потенциально уходящих клиентов и разработки целевых маркетинговых стратегий для повышения их лояльности. Предложенный подход к конструированию признаков и выбору модели может быть адаптирован и для других задач в сфере розничной торговли.

**Ограничениями** данного исследования являются использование данных за относительно короткий период (один месяц), что может не полностью отражать долгосрочные паттерны поведения клиентов, и специфический способ формирования целевой переменной, приведший к высоким метрикам. Кроме того, разработанное приложение является демонстрационным прототипом и не предназначено для промышленной эксплуатации без дальнейшей доработки.

**В качестве направлений для дальнейшего развития можно выделить:**
*   Использование данных за более длительный период для обучения и валидации моделей.
*   Эксперименты с альтернативными способами формирования целевого признака лояльности, возможно, с большим количеством градаций или на основе других бизнес-метрик.
*   Более глубокое исследование методов интерпретации моделей для получения детальных инсайтов о поведении различных сегментов клиентов.
*   Развитие демонстрационного приложения в полнофункциональную систему с интеграцией с CRM-системами компании, расширенными возможностями аналитики и автоматическим обновлением моделей.
*   Проведение A/B тестирования для оценки экономического эффекта от внедрения предложенных подходов к сегментации клиентов и удержанию.

Результаты данной работы представляют собой завершенное исследование, включающее как разработку и тщательную оценку моделей машинного обучения, так и продуманное проектирование системы для их практического использования. 